
\section{ Реализация модели }\label{sec:coding}

Из-за обилия задач, связанных с обработкой текста в Unicode, а также по причине наличия удобных специализированных библиотек в качестве основного языка программирования был выбран Python 3. Впрочем, отдельные задачи, связанные с предобработкой корпуса, писались на Bash. Подробные спецификации использованного софта и аппаратные характеристики используемой машины см. в \cref{appendix:specs}.

\subsection{ Общее окружение: nltk, pygtrie }

Поскольку в ходе эксперимента считались статистики по 7-граммам для корпуса из $79 \cdot 10^6$ предложений, было необходимо хранить статистики эффективно. Для хранения строк подобного вида лучше всего подходит такая структура данных, как префиксное дерево (бор, trie).

Поскольку задачи писать эффективное и масштабируемое префиксное дерево не было, была выбрана его реализация, предоставленная Google в библиотеке pygtrie (см. \cite{python:pygtrie}, \cite{python:pygtrierepo}).

Для получения $n$-грамм, а также различных вспомогательных задач был выбран популярный python-пакет nltk (Natural Language ToolKit, см. \cite{python:nltk})

\subsection{ Полезные утилиты }

\paragraph{ Pickle } Удобный модуль для сериализации/десериализации сложных Python-объектов.

\paragraph{ BeautifulSoup.UnicodeDammit } Спасительный модуль для работы с разнообразными кодировками в составе пакета BeautifulSoup. Особенно мощно работает в связке с библиотеками chardet и cchardet. Без него привести корпус к читабельному виду было бы невозможно.

В качестве подтверждения -- статистика по различным кодировкам в исходном корпусе:

\begin{tabular}{|c|c|} \hline
Кодировка & Количество файлов \\ \hline 
utf-8 & 68789\\ 
iso-8859-2 & 46870\\ 
shift\_jis & 42015\\ 
euc-jp & 2562\\ 
cp932 & 1575\\ 
ascii & 544\\ 
windows-1253 & 436\\ 
iso-8859-7 & 256\\ 
windows-1252 & 78\\ 
iso-8859-5 & 9\\ 
gb2312 & 4\\ 
tis-620 & 4\\ 
ibm866 & 1\\ 
maccyrillic & 1\\ \hline
Всего & 163144 \\ \hline
\end{tabular}

Документацию можно найти в \cite{python:dammit}.

%\paragraph{ Graphviz } Простая утилита и язык для визуализации графов, полезно для вглядывания в префиксные деревья.
%
%\subsection{ Пример работы и статистики }
%
%\todo{ Разобрать предложение и пройтись по этапам визуализации результата (до svg-картинки с траем) -- если будет нужна красивая вода. }